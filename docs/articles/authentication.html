<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Authentication • susoapi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Authentication">
<meta property="og:description" content="susoapi">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">susoapi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/susoapi.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/authentication.html">Authentication</a>
    </li>
    <li>
      <a href="../articles/exporting.html">Exporting</a>
    </li>
    <li>
      <a href="../articles/users.html">Managing users</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/arthur-shaw/susoapi/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="authentication_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Authentication</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/arthur-shaw/susoapi/blob/master/vignettes/authentication.Rmd"><code>vignettes/authentication.Rmd</code></a></small>
      <div class="hidden name"><code>authentication.Rmd</code></div>

    </div>

    
    
<div id="why" class="section level1">
<h1 class="hasAnchor">
<a href="#why" class="anchor"></a>Why</h1>
<p>When connecting to a Survey Solutions server, users are asked for their login and password. These details, taken together, are authentication.</p>
<p>When an API user tries to interact with a Survey Solutions server, the same details are required. That is, each call to the server needs to provide a valid API user name and password.</p>
</div>
<div id="how" class="section level1">
<h1 class="hasAnchor">
<a href="#how" class="anchor"></a>How</h1>
<p>There are two ways to provide authentication:</p>
<ol style="list-style-type: decimal">
<li>Manually</li>
<li>Programmatically</li>
</ol>
<div id="manually" class="section level2">
<h2 class="hasAnchor">
<a href="#manually" class="anchor"></a>Manually</h2>
<p>Every <code>susoapi</code> function that interacts with a server requires the same core parameters: <code>server</code>, <code>user</code>, and <code>password</code>.</p>
<p>The function user could specify those parameters separately for time such a function is used. For example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># first, get all questionnaires</span>
<span class="fu"><a href="../reference/get_questionnaires.html">get_questionnaires</a></span><span class="op">(</span>
  server <span class="op">=</span> <span class="st">"https://example.server"</span>,
  user <span class="op">=</span> <span class="st">"My_API_user1"</span>,
  password <span class="op">=</span> <span class="st">"MySecretPassword2Day"</span>
<span class="op">)</span>

<span class="co"># then, active audio capture for a questionnaire</span>
<span class="fu"><a href="../reference/set_questionnaire_audio.html">set_questionnaire_audio</a></span><span class="op">(</span>
  qnr_id <span class="op">=</span> <span class="st">"72f7160c-12dc-4dd4-9df1-66af819e434d"</span>,
  qnr_version <span class="op">=</span> <span class="fl">1</span>,
  server <span class="op">=</span> <span class="st">"https://example.server"</span>,
  user <span class="op">=</span> <span class="st">"My_API_user1"</span>,
  password <span class="op">=</span> <span class="st">"MySecretPassword2Day"</span>  
<span class="op">)</span></code></pre></div>
<p>The code works. But it is not without a few noteworthy problems. First, this solution involves needless repetition. For a few function calls, this is fairly manageable. For more functiton calls, this becomes tedious and error-prone.</p>
<p>Second, this solution requires these details to be provided each time a function needs them. Put another way, authentication does not persist across R sessions.</p>
<p>Third, this solution stores sensitive information in an unsafe media: a plain-text script or an R session’s memory. If one shares scripts containing these function calls, one of two problems would arise. Either authentication would be shared with all who can access the code (e.g., GitHub repo) or the script would need to be “sanitized” before being shared (e.g., replace the <code>user</code> and <code>password</code> parameter values with <code>"XXXXX"</code>).</p>
</div>
<div id="programmatically" class="section level2">
<h2 class="hasAnchor">
<a href="#programmatically" class="anchor"></a>Programmatically</h2>
<p>The <code>susoapi</code> package offers a better solution that addresses all these problems simultaneously. Rather than provide authentication separately for each function, <code><a href="../reference/set_credentials.html">set_credentials()</a></code> captures authentication once, provides it to each function, and store those sensitive details somewhere safe. Contrast the code below with the code above:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># first, set credentials for connecting with the server</span>
<span class="fu"><a href="../reference/set_credentials.html">set_credentials</a></span><span class="op">(</span>
  server <span class="op">=</span> <span class="st">"https://example.server"</span>,
  user <span class="op">=</span> <span class="st">"My_API_user1"</span>,
  password <span class="op">=</span> <span class="st">"MySecretPassword2Day"</span>
<span class="op">)</span>

<span class="co"># then, get all questionnaires</span>
<span class="fu"><a href="../reference/get_questionnaires.html">get_questionnaires</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># next, active audio capture for a questionnaire</span>
<span class="fu"><a href="../reference/set_questionnaire_audio.html">set_questionnaire_audio</a></span><span class="op">(</span>
  qnr_id <span class="op">=</span> <span class="st">"72f7160c-12dc-4dd4-9df1-66af819e434d"</span>,
  qnr_version <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
<p>The <code><a href="../reference/set_credentials.html">set_credentials()</a></code> function captures authentication and makes it available in two secure places. For the current session, the function loads the parameters to R environment variables: <code>SUSO_SERVER</code> for the server address, <code>SUSO_USER</code> for the API user name, and <code>SUSO_PASSWORD</code> for the API user password. For future sessions, the function writes credentials to the .Renviron and loaded the credentials upon session startup.</p>
<p>The <code>susoapi</code> functions that communicate with the server load source those values from R environment variables. For example, see the default arguments for <code>get_questionnaires</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_questionnaires.html">get_questionnaires</a></span><span class="op">(</span>
  server <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"SUSO_SERVER"</span><span class="op">)</span>,
  user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"SUSO_USER"</span><span class="op">)</span>,
  password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"SUSO_PASSWORD"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>This allows function users to set credentials once an use them several times without any effort.</p>
</div>
<div id="typical-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#typical-workflow" class="anchor"></a>Typical workflow</h2>
<p>When setting credentials for server authentification, the typical workflow is to:</p>
<ul>
<li>Set</li>
<li>Inspect</li>
<li>Check</li>
<li>Correct (optionally)</li>
</ul>
<div id="set" class="section level3">
<h3 class="hasAnchor">
<a href="#set" class="anchor"></a>Set</h3>
<p>To set credentials, one simply uses <code><a href="../reference/set_credentials.html">set_credentials()</a></code> as below:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/set_credentials.html">set_credentials</a></span><span class="op">(</span>
  server <span class="op">=</span> <span class="st">"https://example.server"</span>,
  user <span class="op">=</span> <span class="st">"My_API_user1"</span>,
  password <span class="op">=</span> <span class="st">"MySecretPassword2Day"</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="inspect" class="section level3">
<h3 class="hasAnchor">
<a href="#inspect" class="anchor"></a>Inspect</h3>
<p>To make sure that the function recorded the intended values, one can inspect via <code><a href="../reference/show_credentials.html">show_credentials()</a></code> as here:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/show_credentials.html">show_credentials</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Alternatively, one could fetch individual credentials from R environment variables.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Fetch elements of the credentials</span>

<span class="co"># Server address</span>
<span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"SUSO_SERVER"</span><span class="op">)</span>

<span class="co"># API user name</span>
<span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"SUSO_USER"</span><span class="op">)</span>

<span class="co"># API user password</span>
<span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"SUSO_PASSWORD"</span><span class="op">)</span></code></pre></div>
<p>The <code><a href="../reference/show_credentials.html">show_credentials()</a></code> function makes this process easier and more streamlined.</p>
</div>
<div id="check" class="section level3">
<h3 class="hasAnchor">
<a href="#check" class="anchor"></a>Check</h3>
<p>To check the validity of credentails for authentication, one can use <code><a href="../reference/check_credentials.html">check_credentials()</a></code> as below:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># check that credentials for the fake server are valid (they are not)</span>
<span class="fu"><a href="../reference/check_credentials.html">check_credentials</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="correct" class="section level3">
<h3 class="hasAnchor">
<a href="#correct" class="anchor"></a>Correct</h3>
<p>To correct incorrect credentials, simply use <code><a href="../reference/set_credentials.html">set_credentials()</a></code> again, specifying the correct credentials for authenication.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># correct incorrect credentials</span>
<span class="co"># set the correct ones</span>
<span class="fu"><a href="../reference/set_credentials.html">set_credentials</a></span><span class="op">(</span>
  server <span class="op">=</span> <span class="st">"https://exampleserver.com"</span>,
  user <span class="op">=</span> <span class="st">"My_API_user10"</span>,
  password <span class="op">=</span> <span class="st">"MySecretPassword2Day123"</span>
<span class="op">)</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Arthur Shaw.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
